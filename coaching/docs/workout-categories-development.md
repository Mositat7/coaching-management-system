# برنامه توسعهٔ صفحهٔ دسته‌بندی تمرین‌ها (Workout Categories)

این سند مراحل توسعهٔ حرفه‌ای و گام‌به‌گام بخش **دسته‌بندی تمرین‌ها** را توضیح می‌دهد.

---

## ساختار منطقی داده (سلسله‌مراتب)

```
عضله (Muscle Group)     →  مثلاً: بازو، پا، سینه
  └── زیرمجموعه (Sub)   →  مثلاً: جلو بازو، پشت بازو
        └── تمرین (Exercise)  →  مثلاً: جلو بازو هالتر، دیپ پشت بازو
```

- **عضله:** یک دستهٔ کلی (مثل بازو).
- **زیرمجموعه:** بخشی از آن عضله (مثل جلو بازو / پشت بازو).
- **تمرین:** یک حرکت مشخص (مثل جلو بازو هالتر).

---

## فاز ۱: مدل‌ها و دیتابیس (پایهٔ داده)

**هدف:** تعریف جداول و مدل‌ها تا دادهٔ واقعی داشته باشیم.

| مورد | توضیح |
|------|--------|
| جدول `muscle_groups` | ذخیرهٔ عضلات (نام، آیکون/رنگ، ترتیب نمایش) |
| جدول `muscle_sub_groups` | ذخیرهٔ زیرمجموعه‌ها با ارجاع به `muscle_groups` |
| جدول `workout_exercises` | ذخیرهٔ حرکات با ارجاع به `muscle_sub_groups` |
| مدل‌ها | `MuscleGroup`, `MuscleSubGroup`, `WorkoutExercise` با روابط `hasMany` / `belongsTo` |

**خروجی:** بعد از مایگریشن و سید، کنترلر می‌تواند داده را از دیتابیس بخواند و به ویو بفرستد.

---

## فاز ۲: اتصال ویو به دادهٔ واقعی

**هدف:** صفحه با دادهٔ دیتابیس پر شود، نه HTML ثابت.

- کنترلر در متد `index` با روابط (`with`) همهٔ گروه‌ها، زیرگروه‌ها و تمرین‌ها را بخواند.
- در ویو به‌جای کارت ثابت، از `@foreach($muscleGroups as $group)` و درون آن `@foreach($group->subGroups as $sub)` و `@foreach($sub->exercises as $exercise)` استفاده شود.
- هر کارت با یک کلاس رنگی (مثلاً primary, success, danger) از قبل تعریف‌شده در CSS یا از فیلد دیتابیس (مثل `color_slug`) پر شود.

**خروجی:** صفحه فقط دادهٔ واقعی را نشان می‌دهد و با تغییر دیتابیس به‌روز می‌شود.

---

## فاز ۳: افزودن عضلهٔ جدید (CRUD – Create)

**هدف:** دکمهٔ «افزودن عضله جدید» کار کند.

- روت `POST` برای ذخیرهٔ عضلهٔ جدید (مثلاً `workouts.category.store`).
- فرم در مودال یا صفحهٔ جدا: فیلدهای نام، آیکون (یا انتخاب از لیست)، رنگ/اسلاگ.
- Request برای اعتبارسنجی (مثلاً `StoreMuscleGroupRequest`).
- بعد از ذخیره، ریدایرکت به همان صفحهٔ دسته‌بندی با پیام موفقیت.

**خروجی:** کاربر می‌تواند از داخل همین صفحه عضلهٔ جدید اضافه کند.

---

## فاز ۴: ویرایش و حذف عضله

**هدف:** لینک‌های «ویرایش» و «حذف» در منوی هر کارت واقعی شوند.

- روت‌های `PUT/PATCH` و `DELETE` برای عضله (مثلاً `workouts.category.update`, `workouts.category.destroy`).
- ویرایش: مودال یا صفحهٔ جدا با فرم پر شده از مدل.
- حذف: درخواست DELETE با تأیید (جاوااسکریپت یا فرم با توکن).
- در صورت حذف، زیرمجموعه‌ها و تمرین‌ها طبق طراحی (حذف آبشاری یا محدودیت) مدیریت شوند.

**خروجی:** ویرایش و حذف از روی همان کارت‌ها بدون رفتن به صفحهٔ دیگر (در صورت استفاده از مودال).

---

## فاز ۵: مدیریت زیرمجموعه و تمرین‌ها

**هدف:** «افزودن زیرمجموعه» و «افزودن تمرین» و همین‌طور ویرایش/حذف آن‌ها کار کند.

- روت‌ها و متدهای کنترلر برای:
  - زیرمجموعه: store, update, destroy (با `muscle_group_id`).
  - تمرین: store, update, destroy (با `muscle_sub_group_id`).
- فرم‌ها در مودال (ترجیحاً) تا صفحه عوض نشود و UX سبک بماند.
- در ویو، دکمه‌ها به روت/آدرس مناسب با `muscle_group_id` یا `muscle_sub_group_id` لینک شوند.

**خروجی:** CRUD کامل برای هر سه سطح: عضله، زیرمجموعه، تمرین.

---

## فاز ۶: بهبود تجربهٔ کاربری (UX)

**هدف:** رفتار حرفه‌ای و قابل فهم برای کاربر.

- **پیام‌ها:** بعد از هر عملیات (افزودن/ویرایش/حذف) یک فلش یا توست با موفقیت/خطا.
- **تأیید حذف:** مودال «آیا مطمئن هستید؟» قبل از حذف (برای هر سه سطح).
- **بارگذاری:** در زمان ارسال فرم یا حذف، دکمه یا کارت در حالت لودینگ (مثلاً اسپینر یا غیرفعال شدن دکمه).
- **خطاهای اعتبارسنجی:** نمایش خطاهای فرم زیر هر فیلد یا بالای مودال.

**خروجی:** صفحه از نظر تعامل و بازخورد برای کاربر شفاف و قابل اعتماد است.

---

## ترتیب پیشنهادی کار

1. **فاز ۱** → مایگریشن، مدل‌ها، سید اولیه، سپس اتصال کنترلر به مدل و پاس دادن داده به ویو.
2. **فاز ۲** → تبدیل ویو به حالت داینامیک با `@foreach` و لینک‌های صحیح.
3. **فاز ۳** → فرم و روت افزودن عضله.
4. **فاز ۴** → ویرایش و حذف عضله.
5. **فاز ۵** → همین کارها برای زیرمجموعه و تمرین.
6. **فاز ۶** → پیام، تأیید حذف و لودینگ.

در هر فاز می‌توان ابتدا یک سطح (مثلاً فقط عضله) را کامل کرد و بعد زیرمجموعه و تمرین را اضافه کرد.

---

## فایل‌های مرتبط

| فایل | نقش |
|------|-----|
| `resources/views/admin/plans/workout/Categories/categories.blade.php` | ویوی اصلی صفحه |
| `public/assets/css/pages/workout-categories.css` | استایل مخصوص همین صفحه |
| `app/Http/Controllers/admin/workouts/category/CategoryController.php` | کنترلر صفحه و عملیات CRUD |
| `app/Models/MuscleGroup.php` | مدل عضله |
| `app/Models/MuscleSubGroup.php` | مدل زیرمجموعه |
| `app/Models/WorkoutExercise.php` | مدل تمرین |
| `routes/web.php` | روت‌های مربوط به دسته‌بندی تمرین |

با انجام فاز ۱، پایهٔ داده و مدل‌ها آماده می‌شود و در فاز ۲ می‌توان ویو را کاملاً به دادهٔ واقعی وصل کرد.

---

## نحوهٔ اجرای مایگریشن و سید (بعد از فاز ۱)

```bash
# یک بار اجرا کنید تا جداول ساخته شوند
php artisan migrate

# دادهٔ اولیه (بازو با زیرمجموعه و تمرین، پا و سینه خالی)
php artisan db:seed --class=MuscleGroupSeeder
```

بعد از آن صفحهٔ دسته‌بندی تمرین‌ها با دادهٔ واقعی از دیتابیس پر می‌شود.
